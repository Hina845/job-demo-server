<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* Keep all your existing styles */
        .form-container {
            display: none;
        }
        .form-container.active {
            display: block;
        }
        div {
            margin: 10px 0;
        }
        label {
            display: inline-block;
            width: 120px;
        }
        input, select {
            padding: 5px;
            margin: 5px;
        }
        #response_message {
            white-space: pre-wrap;
            font-family: monospace;
            background-color: #f5f5f5;
            padding: 10px;
            border: 1px solid #ddd;
            max-width: 100%;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <!-- Keep all your existing HTML form content -->

    <p id="response_message"></p>

    <script>
        // Updated to use proper API paths
        function handleFetch(url, data) {
            const responseElement = document.getElementById('response_message');
            responseElement.innerText = 'Sending request...';
            
            fetch(`/api/${url}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
            .then(response => {
                if (!response.ok) {
                    return response.text().then(text => {
                        try {
                            return JSON.parse(text);
                        } catch (e) {
                            throw new Error(`Server returned ${response.status}: ${text || response.statusText}`);
                        }
                    });
                }
                
                return response.json();
            })
            .then(data => {
                responseElement.innerText = JSON.stringify(data, null, 2);
            })
            .catch(error => {
                responseElement.innerText = 'Error: ' + error.message;
                console.error('Fetch error:', error);
            });
        }

        function switchForm() {
            const formType = document.getElementById('formType').value;
            const forms = document.querySelectorAll('.form-container');
            
            forms.forEach(form => form.classList.remove('active'));
            
            if (formType) {
                document.getElementById(formType + 'Form').classList.add('active');
            }
        }

        document.getElementById('limit').addEventListener('click', function(event) {
            event.preventDefault();
            const key = document.getElementById('key').value;
            const params = {
                symbol: document.getElementById('limitSymbol').value,
                price: document.getElementById('limitPrice').value,
                vol: document.getElementById('limitVolume').value,
                side: document.getElementById('limitSide').value === 'buy' ? 1: 3
            }
            handleFetch('limit', { key, params });
        });

        document.getElementById('trigger').addEventListener('click', function(event) {
            event.preventDefault();
            const key = document.getElementById('key').value;
            const params = {
                symbol: document.getElementById('triggerSymbol').value,
                triggerPrice: document.getElementById('triggerTriggerPrice').value,
                triggerType: document.getElementById('triggerType').value === '>=' ? "1" : "2",
                price: document.getElementById('triggerPrice').value,
                vol: document.getElementById('triggerVolume').value,
                side: document.getElementById('triggerSide').value === 'buy' ? 1 : 3
            }
            handleFetch('trigger', { key, params });
        });

        document.getElementById('cancel').addEventListener('click', function(event) {
            event.preventDefault();
            const key = document.getElementById('key').value;
            const params = {
                symbol: document.getElementById('cancelOrderSymbol').value,
                orderID: document.getElementById('cancelOrderID').value
            }
            handleFetch('cancel', { key, params });
        });
    </script>
</body>
</html>